<!DOCTYPE html>
<html lang="en">
<head>
    <title>{{ blog_title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="icon" sizes="16x16" href="{{ asset('favicon.ico') }}" />

    <link rel="stylesheet" href="{{ asset('bundles/blogmain/themes/' ~ blog_theme ~ '/css/bootstrap.css') }}" media="screen">
    <link rel="stylesheet" href="{{ asset('bundles/blogmain/css/blog.css') }}">
    <link rel="stylesheet" href="{{ asset('bundles/blogmain/themes/' ~ blog_theme ~ '/css/theme.css') }}">
    <link rel="stylesheet" href="{{ asset('bundles/blogmain/css/datepicker.css') }}">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="{{ asset('js/html5shiv.js') }}"></script>
    <![endif]-->

    <link rel="icon" type="image/ico" href="{{ asset('bundles/blogmain/favicon.ico') }}">
</head>
<body>

<div id="fb-root"></div>
<script>(function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = "//connect.facebook.net/fi_FI/all.js#xfbml=1";
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
</script>

<div class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <a href="{{ path('homepage') }}" class="navbar-brand">{{ blog_title }}</a>
        </div>
        <div class="navbar-collapse navbar-responsive-collapse">
            <ul class="nav navbar-nav navbar-right">
                <form action="{{ path('search') }}" method="POST" class="navbar-form navbar-right">
                    <input type="text" name="searchPhrase" class="form-control col-lg-8" placeholder="Search">
                </form>
            </ul>
        </div>
    </div>
</div>

<div class="container page">
    <main class="bs-masthead" id="content" role="main">
        {% if app.user and is_granted("IS_AUTHENTICATED_REMEMBERED") %}
            <h1>Hello, {{ app.user }}</h1>
            <p class="lead">You are now ready to create a new post.</p>
        {% else %}
            <h1>{{ blog_hero }}</h1>
            <p class="lead">{{ blog_subhero }}</p>
        {% endif %}
    </main>

    {% for message in app.session.getFlashBag.get('info') %}
        <div class="alert alert-dismissable alert-success">
            <button type="button" class="close" data-dismiss="alert">×</button>
            {{ message }}
        </div>
    {% endfor %}

    {% for message in app.session.getFlashBag.get('warning') %}
        <div class="alert alert-dismissable alert-warning">
            <button type="button" class="close" data-dismiss="alert">×</button>
            {{ message }}
        </div>
    {% endfor %}

    <ul class="breadcrumb" style="margin-bottom: 5px;">
        <li><a href="{{ path('homepage') }}">Home</a></li>
        {% block section %}
            {% if current_category is defined %}
                <li>Category</li>
                <li>{{ current_category.title | capitalize }}</li>
            {% endif %}
        {% endblock %}
    </ul>

    <div class="row">
        <div class="col-sm-8">
            {% block page_content %}{% endblock %}
        </div>
        <div class="col-sm-4">
            <h2>Listings</h2>
            <div class="list-group">
                <a class="list-group-item" href="{{ url('homepage') }}">&raquo; Latest posts</a>
                <a class="list-group-item" href="{{ url('ordered') }}">&raquo; Chronological order</a>
            </div>

            <h2>Categories</h2>
            <div class="list-group">
                {% for category in categories %}
                <a class="list-group-item" href="{{ url('homepage') }}category/{{ category.slug }}">
                    &raquo; {{ category.title | capitalize }}
                    <span class="badge">{{ category.getCountPosts() }}</span>
                </a>
                {% else %}
                    No categories found.
                {% endfor %}
            </div>


                <h2>Admin</h2>
                <div class="list-group">
                    {% if app.user and is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                        {% if categories | length > 0 %}
                            <a class="list-group-item" href="{{ url('new_post') }}">&raquo; New post</a>
                            <a class="list-group-item" href="{{ url('list_unpublished_posts') }}">
                                &raquo; Unpublished posts
                                <span class="badge">{{ unpublished | length }}</span>
                            </a>
                        {% endif %}
                        <a class="list-group-item" href="{{ url('list_categories') }}">&raquo; Categories</a>
                        <a class="list-group-item" href="{{ url('fos_user_security_logout') }}">&raquo; Logout</a>
                    {% else %}
                        <a class="list-group-item" href="{{ url('fos_user_security_login') }}">&raquo; Login</a>
                    {% endif %}
                </div>

        </div>
    </div>
</div>

<hr/>

<section id="footer">
    <div class="bottom-menu-inverse">
        <div class="container footer">
            <div class="row">
                <div class="col-md-6 footer-column">
                    <p>Copyright &copy; {{ "now"|date("Y") }}, {{ blog_copyright }}</p>
                </div>
                <div class="col-md-6 footer-column text-right">
                    <p>{{ blog_email }}</p>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
<script src="{{ asset('bundles/blogmain/js/bootstrap.js') }}"></script>
<script src="{{ asset('bundles/blogmain/js/bootstrap-datepicker.js') }}"></script>

{% block javascripts %}{% endblock %}

</body>
</html>